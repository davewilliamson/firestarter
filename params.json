{"name":"Firestarter","tagline":"Taking away the complexity of starting and stopping your application","body":"![firestarter](https://f.cloud.github.com/assets/1398082/989783/6ba1d050-091b-11e3-827f-cd334a77ac6a.png)\r\n\r\n[![Build Status](https://travis-ci.org/davewilliamson/firestarter.png?branch=master)](https://travis-ci.org/davewilliamson/firestarter)\r\n[![Dependency Status](https://www.versioneye.com/user/projects/520f9bd0632bac1d6e001837/badge.png)](https://www.versioneye.com/user/projects/520f9bd0632bac1d6e001837)\r\n[![NPM version](https://badge.fury.io/js/firestarter.png)](http://badge.fury.io/js/firestarter)\r\n\r\nThis is a must-have module for anybody writing applications using express.\r\n\r\n\r\n## Installation\r\n\r\n\tCommand Shell:\r\n\tnpm install firestarter\r\n\t\r\n\tIn app:\r\n\tvar firestarter=require('firestarter')();\r\n    \r\n\r\n\r\n### A tool for express to start/stop your application\r\nFirestarter takes away the complexity of starting and stopping your application, it handles ALL errors (both thrown, and unexpected exceptions) with ease, allowing you to concentrate on writing your app.\r\n\r\nFirstly, it wraps your entire application in a Domain, and handles any errors from that domain, by cleanly shutting down the application - when combined with a tool such as naught, this will ensure that your app is as stable (from a user point of view) as it can possibly be.\r\n\r\n**NOTE** THIS MODULE REQUIRES THAT YOUR PROJECT IS USING EXPRESS\r\n\r\nThe code is simple (this is pretty much your app.js):\r\n\t\r\n\tvar firestarter = require('firestarter')()\r\n\t  , db;\r\n\t\r\n\tfirestarter.startup(function(app, done){\r\n\t\t// This is where you put all the app initialisation logic, e.g.\r\n\t\r\n\t\tvar data = db.createConnection(server);\r\n\t\r\n\t\tapp.set('port', 3000);\r\n\t\tapp.set('version', 'v0.0.1');\r\n\t\r\n\t\tapp.use(express.logger());\r\n\t\t// etc....\r\n\t\t\r\n\t\tapp.use(app.route);\r\n\t\tapp.use(function(err, req, res, next){\r\n\t\t\t// DO SOMETHING - then end with....\r\n\t\r\n\t\t\tres.firestarter.shutdown(err);\r\n\t\t});\r\n\t\r\n\t\tapp.get('/', getTheHomePage);\r\n\t\r\n\t\tdone();\r\n\t\r\n\t}, function(done){\r\n\t\t// This is where you put your shutdown logic\r\n\t\r\n\t\tdata.closeConnection();\r\n\t\r\n\t\tdone();\r\n\t\r\n\t}, function(){\r\n\t\t// This will be triggered when the server is listening and ready to serve data.\r\n\t\t\r\n\t});\r\n\r\n---\r\n\t\r\n### More Info\r\n\r\nThe main 2 commands are:\r\n\r\n\tstartup(init, onShutdown, onReady)\r\n\t\r\n\t- and -\r\n\r\n\tshutdown(err)\r\n\t\r\nstartup(fn, fn, fn) - gets passed at least one (init), and upto 3 callback functions:\r\n\r\n1. init - This is the code that used for setting up application (the normal app.use chain), it is passed a callback so when you have set everything up, you can carry on to start the application listening.  In the init function, you should initialise any datasources you app will use, and setup any load-time variables or configs.  \r\n\r\n2. onShutdown - As the name suggests, this gets called if the app has to shutdown, it is called AFTER the server portion of the app has finished processing connections, and is passed a callback so you can confirm you have finish, and get the app terminated.\r\n  \r\n3. onReady - When the app is up & listening, this will get called to let you know the app is up.\r\n\r\n\t\r\nshutdown(err) - err is optional, this is the manual way to shutdown the application.\r\n\r\nThere is also the initial require, that allows you to pass config options:\r\n\r\n\tvar firestarter=require('firestarter')({});\r\n\t\r\nThe object that can be passed at the end, is for configuration options:\r\n\r\n\tvar config = {\r\n\t\t  shutdownTimeout : 300\t\t\t\t// seconds, default to 5 mins\r\n\t\t, startupTimeout : 300\t\t\t\t// seconds, default to 5 mins\r\n\t\t, express : require('express')\t\t\t// You 'can' pass express if required(?)\r\n\t\t, domain : require('domain')\t\t\t// You 'can' pass domain if required(?)\r\n\t\t, http : require('http')\t\t\t// You 'can' pass http if required(?)\r\n\t\t, app : require('express')()\t\t\t// You 'can' pass your own app if required(?)\r\n\t};\r\n\r\nIn real terms, most of the use cases would not need to chance the defaults, so passing a null object would be normal.\r\n\r\n---\r\n\r\n### Under the covers\r\nFirestarter does a number of things\r\n\r\n* It informs program monitors (such as naught) that it is online or offline, by sending them a process message.\r\n\r\n* It monitors the server activity, on shutdown, to ensure all connections (where possible) are terminated before quitting.\r\n\r\n* It monitors ALL parts of your application for errors and exceptions, and handles them by attempting a clean shutdown.\r\n\r\n\t\r\n","google":"UA-37688960-1","note":"Don't delete this file! It's used internally to help with page regeneration."}